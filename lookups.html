<HTML>
	<HEAD>
		<SCRIPT>var isomorphicDir="../smartclientRuntime/isomorphic/";</SCRIPT>
		<SCRIPT SRC=../smartclientRuntime/isomorphic/system/modules/ISC_Core.js></SCRIPT>
		<SCRIPT SRC=../smartclientRuntime/isomorphic/system/modules/ISC_Foundation.js></SCRIPT>
		<SCRIPT SRC=../smartclientRuntime/isomorphic/system/modules/ISC_Containers.js></SCRIPT>
		<SCRIPT SRC=../smartclientRuntime/isomorphic/system/modules/ISC_Grids.js></SCRIPT>
		<SCRIPT SRC=../smartclientRuntime/isomorphic/system/modules/ISC_Forms.js></SCRIPT>
		<SCRIPT SRC=../smartclientRuntime/isomorphic/system/modules/ISC_DataBinding.js></SCRIPT>
		<SCRIPT SRC=../smartclientRuntime/isomorphic/skins/Graphite/load_skin.js></SCRIPT>
	</HEAD>
	<BODY>
<SCRIPT>
isc.defineClass("myListGrid", "ListGrid").addProperties({
	alternateRecordStyles: true,
	autoFitFieldWidths: true,
	autoFitWidthApproach: 'title',
	canDragResize: true,
	height: 150,
	leaveScrollbarGap: false,
	left: 5,
	shadowOffset: 3,
	shadowSoftness: 7,
	showAllRecords: true,
	showShadow: true,
	selectionStyle: "single",
	width: 650,
	dataArrived: function(startRow, endRow){
		this.selectSingleRecord(startRow);
		this.recordClick(this, startRow, startRow);
	}
});
isc.defineClass("myDataSource", "DataSource").addProperties({
	dataFormat: "json",
	operationBindings:[{operationType:"fetch", dataProtocol:"postParams"}]
	// willHandleError: true
	// handleError: function(response, request){
	// 	isc.warn('sadfsadfsdf');
	// 	return true;
	// }
});
isc.defineClass("myLabel", "Label").addProperties({
	baseStyle: "headerItem",
	height: 1,
	width: 500
});

isc.LookupLayout = isc.VLayout.create({
	canDragResize: true,
	name: "Lookups",
	parent: this,
	title: "Lookups",
	initWidget: function(initData){
		this.Super("initWidget", arguments);

		this.lookupDS = isc.myDataSource.create({
			dataURL: "Lookups.php",
			ID: "lookupDS",
			fields:[
				{name: "lookupID", primaryKey: true, detail: true},
				{name: "category", width: 80},
				{name: "lookupName", width: 80, detail: true},
				{name: "lookupRef", width: 80},
				{name: "itemName"},
				{name: "itemRef", width: 80, detail: true},
				{name: "itemDetail", detail: true}
			]
		});
		this.lookupLG = isc.myListGrid.create({
			margin: 4,
			autoFetchData: true,
			dataSource: this.lookupDS,
			groupByField: "lookupName",
			groupStartOpen: "none",
			height: 600,
			ID: "lookupLG",
			parent: this,
			showFilterEditor: true,
			showGroupSummary: true,
			width: 300,
			recordClick: function(viewer, record, recordNum, field, fieldNum, value, rawValue){
				if(record.itemDetail > ""){
					viewer.parent.detailDF.setValue("itemDetail", record.itemDetail);
				}
			}
		});
		this.detailDF = isc.DynamicForm.create({
			parent: this,
			canDragResize: true,
			canEdit: false,
			height: 600,
			titleOrientation: "none",
			fields: [
				{name: "itemDetail", editorType: "TextAreaItem", width: 600, minHeight: 600}
			]
		});

		this.mainLB = isc.myLabel.create({contents: "<bold><h2>GURPS Lookups</h2></bold>"});

		this.SearchLayoutVL = isc.VLayout.create({
			margin: 4,
			align: "left",
			backgroundColor: "#66B2FF",
			edgeBackgroundColor: "#DCDCDC",
			parent: this,
			members: [this.mainLB, this.lookupLG, this.detailDF]
		});
		this.DetailLayoutVL = isc.VLayout.create({
			backgroundColor: "#999900",
			edgeBackgroundColor: "#DCDCDC",
			margin: 4,
			parent: this,
			layoutTopMargin: 30,
			align: "left",
			width: "*",
			members: [this.detailDF]
		});

		this.PageLayout = isc.HLayout.create({
			margin: 4,
			width: "99%",
			parent: this,
			members: [this.SearchLayoutVL, this.DetailLayoutVL],
		});
		this.DetailLayoutHL
		this.addMember(this.PageLayout);
		// this.lookupLG.filterData({category: "Hazards"});
	}
});
</SCRIPT>
</BODY>
</HTML>
